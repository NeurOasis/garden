<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NINYE Puzzle Solver - GARDEN Edition</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a2e;
            color: #eee;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: #16213e;
            padding: 20px;
            border-bottom: 2px solid #0f3460;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            color: #e94560;
            margin-bottom: 10px;
        }
        
        .garden-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #4a6fa5;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
        }
        
        .hint-box {
            background: #0f3460;
            padding: 15px;
            border-radius: 8px;
            margin: 20px;
            border: 2px solid #e94560;
        }
        
        .visual-hint {
            background: #16213e;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            font-family: monospace;
            font-size: 24px;
            text-align: center;
            letter-spacing: 5px;
        }
        
        .main-container {
            display: flex;
            flex: 1;
            gap: 20px;
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
        }
        
        .section {
            background: #16213e;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        
        .input-section {
            flex: 1;
        }
        
        .analysis-section {
            flex: 2;
        }
        
        .scraper-section {
            flex: 1;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #e94560;
            font-weight: bold;
        }
        
        input, textarea {
            width: 100%;
            padding: 10px;
            background: #0f3460;
            border: 1px solid #533483;
            border-radius: 5px;
            color: #eee;
            font-size: 16px;
        }
        
        textarea {
            min-height: 200px;
            resize: vertical;
        }
        
        button {
            background: #e94560;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            margin-right: 10px;
            margin-top: 10px;
        }
        
        button:hover {
            background: #c23650;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .word-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .word-item {
            background: #0f3460;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #533483;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .word-item:hover {
            border-color: #e94560;
            transform: scale(1.02);
        }
        
        .word-item.eliminated {
            opacity: 0.4;
            text-decoration: line-through;
        }
        
        .word-item.verified-fail {
            background: #3e1616;
            border-color: #8b0000;
        }
        
        .count {
            background: #533483;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
        }
        
        .pattern-analysis {
            margin-top: 20px;
            padding: 15px;
            background: #0f3460;
            border-radius: 8px;
        }
        
        .pattern-item {
            margin: 10px 0;
            padding: 10px;
            background: #1a1a2e;
            border-radius: 5px;
        }
        
        .probability-bar {
            height: 20px;
            background: #0f3460;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .probability-fill {
            height: 100%;
            background: linear-gradient(90deg, #533483, #e94560);
            transition: width 0.3s;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: #0f3460;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 28px;
            color: #e94560;
            font-weight: bold;
        }
        
        .stat-label {
            color: #aaa;
            font-size: 14px;
            margin-top: 5px;
        }
        
        .candidate-section {
            margin-top: 20px;
            padding: 20px;
            background: #0f3460;
            border-radius: 8px;
            border: 2px solid #e94560;
        }
        
        .candidate-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .candidate-word {
            background: #16213e;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #533483;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
        }
        
        .candidate-word:hover {
            border-color: #e94560;
            transform: scale(1.05);
        }
        
        .candidate-score {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #e94560;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .letter-frequency {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .letter-stat {
            background: #1a1a2e;
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #533483;
        }
        
        .scraper-status {
            background: #0f3460;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 14px;
        }
        
        .scraper-status.success {
            border-left: 4px solid #4CAF50;
        }
        
        .scraper-status.error {
            border-left: 4px solid #e94560;
        }
        
        .scraper-status.loading {
            border-left: 4px solid #ffaa00;
        }
        
        .phrase-matcher {
            margin-top: 20px;
            padding: 15px;
            background: #0f3460;
            border-radius: 8px;
        }
        
        .phrase-item {
            background: #1a1a2e;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .phrase-item:hover {
            background: #2a2a3e;
            transform: translateX(5px);
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #e94560;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #0f3460;
        }
        
        .tab {
            padding: 10px 20px;
            background: none;
            border: none;
            color: #aaa;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            color: #e94560;
            border-bottom-color: #e94560;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .social-results {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 10px;
        }
        
        .social-item {
            background: #0f3460;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .social-item .date {
            color: #888;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîç NINYE Password Puzzle Solver</h1>
        <p>Advanced pattern analysis with YouTube comment scraping</p>
        <span class="garden-badge">GARDEN Tool v1.0</span>
    </div>
    
    <div class="hint-box">
        <h3>üìå Known Hints:</h3>
        <ul id="hintsList">
            <li>Single word, no numbers</li>
            <li>Starts with "F"</li>
            <li>Capitalization doesn't matter</li>
            <li>6-7 characters long (based on visual)</li>
            <li>Format shown: "F_____ is" (suggesting a statement)</li>
            <li>Video will be taken down when correct</li>
            <li>1 week deadline - money involved</li>
        </ul>
        <div class="visual-hint">F _ _ _ _ _ is</div>
    </div>
    
    <div class="main-container">
        <div class="section scraper-section">
            <h2>üåê YouTube Scraper</h2>
            
            <div class="tabs">
                <button class="tab active" onclick="switchTab('comments')">Comments</button>
                <button class="tab" onclick="switchTab('social')">Social Media</button>
                <button class="tab" onclick="switchTab('videos')">Other Videos</button>
            </div>
            
            <div class="tab-content active" id="comments-tab">
                <div class="input-group">
                    <label>YouTube Video URL:</label>
                    <input type="text" id="videoUrl" value="https://youtube.com/shorts/Bpr_9OZltJQ" placeholder="Enter YouTube URL">
                </div>
                
                <button onclick="scrapeComments()" id="scrapeBtn">
                    <span id="scrapeBtnText">üîÑ Scrape Comments</span>
                    <span class="loading-spinner" style="display:none"></span>
                </button>
                
                <div class="scraper-status" id="scraperStatus" style="display:none"></div>
                
                <div class="input-group" style="margin-top: 20px;">
                    <label>Manual Comment Input:</label>
                    <textarea id="manualComments" placeholder="Paste comments here (one guess per line)"></textarea>
                </div>
            </div>
            
            <div class="tab-content" id="social-tab">
                <button onclick="searchSocialMedia()">üîç Search NINYE's Social Media</button>
                <div class="social-results" id="socialResults"></div>
            </div>
            
            <div class="tab-content" id="videos-tab">
                <button onclick="searchOtherVideos()">üìπ Check Other NINYE Videos</button>
                <div class="social-results" id="videoResults"></div>
            </div>
        </div>
        
        <div class="section analysis-section">
            <h2>üìä Analysis Dashboard</h2>
            
            <div class="stats" id="statsContainer">
                <div class="stat-card">
                    <div class="stat-value" id="totalGuesses">0</div>
                    <div class="stat-label">Total Guesses</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="uniqueWords">0</div>
                    <div class="stat-label">Unique Words</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="correctLength">0</div>
                    <div class="stat-label">6-7 Letter Words</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="timeRemaining">7d</div>
                    <div class="stat-label">Time Remaining</div>
                </div>
            </div>
            
            <div class="pattern-analysis">
                <h3>üéØ Pattern Analysis</h3>
                <div id="patternResults"></div>
            </div>
            
            <div class="phrase-matcher">
                <h3>üí≠ Common Phrases with "F_____ is"</h3>
                <div id="phraseMatches"></div>
            </div>
            
            <div class="candidate-section">
                <h3>üí° Top Candidates (Not Yet Guessed)</h3>
                <p style="color: #aaa; font-size: 14px; margin-bottom: 10px;">
                    Click to copy ‚Ä¢ Score based on patterns, phrase matching, and context
                </p>
                <div class="candidate-grid" id="candidateWords"></div>
            </div>
        </div>
        
        <div class="section input-section">
            <h2>üìù Guess Tracker</h2>
            
            <div class="input-group">
                <label>Additional Hints:</label>
                <input type="text" id="newHint" placeholder="Enter any new hints discovered">
                <button onclick="addHint()">‚ûï Add Hint</button>
            </div>
            
            <div style="margin-top: 20px;">
                <button onclick="analyzeAll()">üîç Analyze All Data</button>
                <button onclick="exportToGarden()">üå± Export to GARDEN</button>
                <button onclick="clearData()">üóëÔ∏è Clear All</button>
            </div>
            
            <h3 style="margin-top: 30px;">üìù Guessed Words</h3>
            <p style="color: #aaa; font-size: 14px;">Click to mark as eliminated</p>
            <div class="word-grid" id="wordGrid"></div>
        </div>
    </div>
    
    <script>
        // Global data storage
        let guessedWords = new Map();
        let patterns = new Map();
        let phraseDatabase = new Map();
        let scrapedData = {
            comments: [],
            social: [],
            videos: []
        };
        
        // Enhanced candidate pool for 6-7 letter F-words
        const candidatePool = [
            // Common words
            'FUTURE', 'FAMILY', 'FRIEND', 'FROZEN', 'FOREST', 'FINGER',
            'FRANCE', 'FRIDAY', 'FELLOW', 'FILTER', 'FLIGHT', 'FOLDER',
            'FORMAL', 'FALCON', 'FABRIC', 'FACTOR', 'FAMOUS', 'FASTER',
            'FATHER', 'FEMALE', 'FIGURE', 'FINALS', 'FINDER', 'FINISH',
            'FISHER', 'FLAMES', 'FLOWER', 'FLYING', 'FOLLOW', 'FORGET',
            'FORMAT', 'FORUMS', 'FOSTER', 'FOUGHT', 'FOURTH', 'FRAMES',
            'FREELY', 'FRENCH', 'FRIDGE', 'FRONTS', 'FRUITS', 'FUSION',
            // Money/Business related
            'FOREX', 'FUNDS', 'FISCAL', 'FUTURES',
            // Tech related
            'FINDER', 'FOLDER', 'FIREFOX', 'FAILED',
            // Time related
            'FINITE', 'FINALS', 'FOREVER'
        ];
        
        // Common phrases database
        const commonPhrases = [
            { phrase: "Future is bright", word: "FUTURE", context: "optimistic" },
            { phrase: "Future is now", word: "FUTURE", context: "motivation" },
            { phrase: "Future is uncertain", word: "FUTURE", context: "philosophical" },
            { phrase: "Family is everything", word: "FAMILY", context: "values" },
            { phrase: "Family is important", word: "FAMILY", context: "values" },
            { phrase: "Friend is loyal", word: "FRIEND", context: "relationship" },
            { phrase: "Friday is here", word: "FRIDAY", context: "time" },
            { phrase: "Failure is temporary", word: "FAILURE", context: "motivation" },
            { phrase: "Freedom is earned", word: "FREEDOM", context: "philosophical" },
            { phrase: "Forever is long", word: "FOREVER", context: "time" }
        ];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateTimeRemaining();
            generatePhraseMatches();
            setInterval(updateTimeRemaining, 60000); // Update every minute
        });
        
        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }
        
        // API configuration
        const API_BASE = window.location.hostname === 'localhost' 
            ? 'http://localhost:5000/api' 
            : 'https://ninye-puzzle-api.vercel.app/api';
        
        // Real YouTube comment scraper using API
        async function scrapeComments() {
            const btn = document.getElementById('scrapeBtn');
            const status = document.getElementById('scraperStatus');
            const spinner = btn.querySelector('.loading-spinner');
            const btnText = document.getElementById('scrapeBtnText');
            const videoUrl = document.getElementById('videoUrl').value;
            
            if (!videoUrl) {
                alert('Please enter a YouTube URL');
                return;
            }
            
            btn.disabled = true;
            spinner.style.display = 'inline-block';
            btnText.textContent = 'Scraping...';
            
            status.style.display = 'block';
            status.className = 'scraper-status loading';
            status.innerHTML = '‚è≥ Connecting to YouTube API...';
            
            try {
                const response = await fetch(`${API_BASE}/analyze-video`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ video_url: videoUrl })
                });
                
                const data = await response.json();
                
                if (data.status === 'success' || data.status === 'mock_data') {
                    // Process the analysis
                    if (data.analysis && data.analysis.word_counts) {
                        // Clear existing data
                        guessedWords.clear();
                        
                        // Add words from API
                        Object.entries(data.analysis.word_counts).forEach(([word, count]) => {
                            guessedWords.set(word, count);
                        });
                        
                        // Update patterns from API
                        if (data.analysis.patterns) {
                            patterns.clear();
                            Object.entries(data.analysis.patterns).forEach(([key, values]) => {
                                if (typeof values === 'object') {
                                    Object.entries(values).forEach(([subkey, count]) => {
                                        patterns.set(`${key}: ${subkey}`, count);
                                    });
                                }
                            });
                        }
                    }
                    
                    status.className = 'scraper-status success';
                    status.innerHTML = data.status === 'mock_data' 
                        ? `‚ö†Ô∏è Using mock data (${data.analysis.total_guesses} comments). ${data.message}`
                        : `‚úÖ Analyzed ${data.analysis.total_guesses} F-word guesses from ${data.video_info.comments} comments!`;
                    
                    // Update display
                    updateDisplay();
                    
                    // Display API candidates
                    if (data.candidates) {
                        displayAPICandidates(data.candidates);
                    }
                    
                    // Show top comments if available
                    if (data.analysis.top_comments) {
                        displayTopComments(data.analysis.top_comments);
                    }
                } else {
                    throw new Error(data.error || 'Unknown error');
                }
            } catch (error) {
                status.className = 'scraper-status error';
                status.innerHTML = `‚ùå Error: ${error.message}`;
                console.error('Scraping error:', error);
            } finally {
                btn.disabled = false;
                spinner.style.display = 'none';
                btnText.textContent = 'üîÑ Scrape Comments';
            }
        }
        
        // Display candidates from API
        function displayAPICandidates(apiCandidates) {
            const candidateWords = document.getElementById('candidateWords');
            candidateWords.innerHTML = '';
            
            apiCandidates.forEach(({ word, score }) => {
                const item = document.createElement('div');
                item.className = 'candidate-word';
                item.innerHTML = `
                    ${word}
                    <div class="candidate-score">${score}</div>
                `;
                item.title = `Score: ${score} - Click to copy`;
                item.onclick = () => copyToClipboard(word);
                candidateWords.appendChild(item);
            });
        }
        
        // Display top comments
        function displayTopComments(comments) {
            const patternResults = document.getElementById('patternResults');
            
            if (comments && comments.length > 0) {
                const commentsHtml = `
                    <div style="margin-top: 20px;">
                        <h4>üí¨ Top Comments with Guesses:</h4>
                        ${comments.map(c => `
                            <div style="background: #1a1a2e; padding: 10px; margin: 5px 0; border-radius: 5px;">
                                <strong>${c.author}</strong> (${c.likes} likes)
                                <div>Guesses: ${c.guesses.join(', ')}</div>
                                <div style="color: #888; font-size: 12px;">${c.text_preview}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                patternResults.innerHTML += commentsHtml;
            }
        }
        
        // Analyze all data
        function analyzeAll() {
            const manualInput = document.getElementById('manualComments').value;
            const lines = manualInput.split('\n').filter(line => line.trim());
            
            // Reset and analyze
            guessedWords.clear();
            patterns.clear();
            
            lines.forEach(line => {
                const word = line.trim().toUpperCase();
                if (word.startsWith('F') && /^[A-Z]+$/.test(word)) {
                    guessedWords.set(word, (guessedWords.get(word) || 0) + 1);
                    
                    // Pattern analysis
                    const length = word.length;
                    patterns.set(`Length ${length}`, (patterns.get(`Length ${length}`) || 0) + 1);
                    
                    if (word.length > 1) {
                        const secondLetter = word[1];
                        patterns.set(`2nd: ${secondLetter}`, (patterns.get(`2nd: ${secondLetter}`) || 0) + 1);
                    }
                    
                    if (word.length > 2) {
                        const thirdLetter = word[2];
                        patterns.set(`3rd: ${thirdLetter}`, (patterns.get(`3rd: ${thirdLetter}`) || 0) + 1);
                    }
                }
            });
            
            updateDisplay();
            generateCandidates();
        }
        
        // Update display
        function updateDisplay() {
            // Stats
            const totalCount = Array.from(guessedWords.values()).reduce((a, b) => a + b, 0);
            document.getElementById('totalGuesses').textContent = totalCount;
            document.getElementById('uniqueWords').textContent = guessedWords.size;
            
            // Count 6-7 letter words
            let correctLengthCount = 0;
            guessedWords.forEach((count, word) => {
                if (word.length >= 6 && word.length <= 7) {
                    correctLengthCount += count;
                }
            });
            document.getElementById('correctLength').textContent = correctLengthCount;
            
            // Display words
            const wordGrid = document.getElementById('wordGrid');
            wordGrid.innerHTML = '';
            
            const sortedWords = Array.from(guessedWords.entries())
                .sort((a, b) => b[1] - a[1]);
            
            sortedWords.forEach(([word, count]) => {
                const item = document.createElement('div');
                item.className = 'word-item';
                if (word.length < 6 || word.length > 7) {
                    item.classList.add('eliminated');
                }
                item.innerHTML = `
                    <span>${word} (${word.length})</span>
                    <span class="count">${count}</span>
                `;
                item.onclick = () => item.classList.toggle('eliminated');
                wordGrid.appendChild(item);
            });
            
            // Patterns
            displayPatterns();
        }
        
        // Display pattern analysis
        function displayPatterns() {
            const patternResults = document.getElementById('patternResults');
            patternResults.innerHTML = '';
            
            const sortedPatterns = Array.from(patterns.entries())
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            sortedPatterns.forEach(([pattern, count]) => {
                const total = Array.from(guessedWords.values()).reduce((a, b) => a + b, 0);
                const percentage = ((count / total) * 100).toFixed(1);
                
                const item = document.createElement('div');
                item.className = 'pattern-item';
                item.innerHTML = `
                    <div>${pattern}: ${count} occurrences (${percentage}%)</div>
                    <div class="probability-bar">
                        <div class="probability-fill" style="width: ${percentage}%"></div>
                    </div>
                `;
                patternResults.appendChild(item);
            });
        }
        
        // Generate smart candidates
        function generateCandidates() {
            const candidateWords = document.getElementById('candidateWords');
            candidateWords.innerHTML = '';
            
            // Filter for 6-7 letter words not yet guessed
            const unguessed = candidatePool.filter(word => 
                !guessedWords.has(word) && word.length >= 6 && word.length <= 7
            );
            
            // Score candidates
            const scored = unguessed.map(word => {
                let score = 0;
                
                // Base score for correct length
                if (word.length === 6 || word.length === 7) score += 20;
                
                // Pattern matching
                patterns.forEach((count, pattern) => {
                    if (pattern.startsWith('2nd:') && word[1] === pattern.split(': ')[1]) {
                        score += count * 3;
                    }
                    if (pattern.startsWith('3rd:') && word[2] === pattern.split(': ')[1]) {
                        score += count * 2;
                    }
                });
                
                // Phrase matching bonus
                const matchingPhrases = commonPhrases.filter(p => p.word === word);
                score += matchingPhrases.length * 15;
                
                // Context bonus (money/time related)
                if (['FUTURE', 'FUTURES', 'FINITE', 'FRIDAY', 'FOREVER'].includes(word)) {
                    score += 10;
                }
                
                return { word, score, phrases: matchingPhrases };
            });
            
            // Sort and display top candidates
            scored.sort((a, b) => b.score - a.score);
            scored.slice(0, 15).forEach(({ word, score, phrases }) => {
                const item = document.createElement('div');
                item.className = 'candidate-word';
                item.innerHTML = `
                    ${word}
                    <div class="candidate-score">${score}</div>
                `;
                item.title = phrases.length > 0 ? 
                    `Matches: ${phrases.map(p => p.phrase).join(', ')}` : 
                    `Score: ${score}`;
                item.onclick = () => copyToClipboard(word);
                candidateWords.appendChild(item);
            });
        }
        
        // Generate phrase matches
        function generatePhraseMatches() {
            const phraseMatches = document.getElementById('phraseMatches');
            phraseMatches.innerHTML = '';
            
            // Group by word
            const grouped = {};
            commonPhrases.forEach(phrase => {
                if (!grouped[phrase.word]) grouped[phrase.word] = [];
                grouped[phrase.word].push(phrase);
            });
            
            // Display grouped phrases
            Object.entries(grouped).forEach(([word, phrases]) => {
                if (word.length >= 6 && word.length <= 7) {
                    phrases.forEach(phrase => {
                        const item = document.createElement('div');
                        item.className = 'phrase-item';
                        item.innerHTML = `
                            <strong>"${phrase.phrase}"</strong>
                            <span style="color: #888; margin-left: 10px;">(${phrase.context})</span>
                        `;
                        item.onclick = () => {
                            copyToClipboard(word);
                            alert(`Copied "${word}" from phrase "${phrase.phrase}"`);
                        };
                        phraseMatches.appendChild(item);
                    });
                }
            });
        }
        
        // Add hint
        function addHint() {
            const newHint = document.getElementById('newHint').value.trim();
            if (newHint) {
                const hintsList = document.getElementById('hintsList');
                const li = document.createElement('li');
                li.textContent = newHint;
                hintsList.appendChild(li);
                document.getElementById('newHint').value = '';
            }
        }
        
        // Update time remaining
        function updateTimeRemaining() {
            const deadline = new Date();
            deadline.setDate(deadline.getDate() + 7);
            const now = new Date();
            const diff = deadline - now;
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            
            document.getElementById('timeRemaining').textContent = `${days}d ${hours}h`;
        }
        
        // Export to GARDEN
        function exportToGarden() {
            const data = {
                timestamp: new Date().toISOString(),
                puzzle: 'NINYE Password Challenge',
                hints: Array.from(document.getElementById('hintsList').children).map(li => li.textContent),
                guessedWords: Array.from(guessedWords.entries()),
                patterns: Array.from(patterns.entries()),
                topCandidates: Array.from(document.querySelectorAll('.candidate-word')).map(el => ({
                    word: el.textContent.trim(),
                    score: el.querySelector('.candidate-score').textContent
                }))
            };
            
            // Save to GARDEN findings
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ninye-puzzle-${Date.now()}.json`;
            a.click();
            
            alert('Analysis exported to GARDEN findings!');
        }
        
        // Mock social media search
        function searchSocialMedia() {
            const results = document.getElementById('socialResults');
            results.innerHTML = '<div class="social-item">‚è≥ Searching NINYE\'s social media...</div>';
            
            setTimeout(() => {
                results.innerHTML = `
                    <div class="social-item">
                        <strong>Twitter @NINYE</strong>
                        <div>Hint: "Think about what matters most" ü§î</div>
                        <div class="date">2 hours ago</div>
                    </div>
                    <div class="social-item">
                        <strong>Instagram Story</strong>
                        <div>Shows calendar with 7 days circled</div>
                        <div class="date">5 hours ago</div>
                    </div>
                `;
            }, 1500);
        }
        
        // Mock other videos search
        function searchOtherVideos() {
            const results = document.getElementById('videoResults');
            results.innerHTML = '<div class="social-item">‚è≥ Searching other NINYE videos...</div>';
            
            setTimeout(() => {
                results.innerHTML = `
                    <div class="social-item">
                        <strong>Previous Puzzle Video</strong>
                        <div>Used word "CHANGE" - single concept word</div>
                        <div class="date">1 week ago</div>
                    </div>
                    <div class="social-item">
                        <strong>Puzzle Pattern</strong>
                        <div>Often uses motivational/time-related words</div>
                        <div class="date">Analysis</div>
                    </div>
                `;
            }, 1500);
        }
        
        // Utility functions
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Visual feedback
                event.target.style.background = '#4CAF50';
                setTimeout(() => {
                    event.target.style.background = '';
                }, 300);
            });
        }
        
        function clearData() {
            if (confirm('Clear all data?')) {
                document.getElementById('manualComments').value = '';
                guessedWords.clear();
                patterns.clear();
                updateDisplay();
                document.getElementById('candidateWords').innerHTML = '';
            }
        }
    </script>
</body>
</html>